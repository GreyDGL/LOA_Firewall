2025-06-08 01:13:31,762 - root - INFO - Loaded custom config from config/config.json
2025-06-08 01:13:31,762 - root - INFO - Initializing LLM Firewall
2025-06-08 01:13:31,763 - root - INFO - Keyword filter initialized successfully
2025-06-08 01:13:32,092 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:13:32,092 - root - INFO - Guard llama_guard initialized successfully
2025-06-08 01:13:32,312 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:13:32,317 - root - INFO - Guard granite_guard initialized successfully
2025-06-08 01:13:32,317 - root - INFO - Firewall initialized with 2 guards and keyword filter enabled
2025-06-08 01:13:32,320 - root - INFO - Starting LLM Firewall API on 0.0.0.0:5001
2025-06-08 01:13:32,320 - root - INFO - Starting API server on 0.0.0.0:5001
2025-06-08 01:13:32,324 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5001
 * Running on http://192.168.0.184:5001
2025-06-08 01:13:32,324 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-08 01:13:39,737 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:13:39] "GET /health HTTP/1.1" 200 -
2025-06-08 01:13:39,739 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:13:39] "GET /health HTTP/1.1" 200 -
2025-06-08 01:13:39,740 - root - INFO - Request ebbee19b-aefe-46ed-b386-bcc436c2853e received at /check
2025-06-08 01:13:40,052 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:13:40,380 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:13:40,382 - firewall_analysis - INFO - FIREWALL_SAFE | STATUS=SAFE | HASH=9e46da316ef16f99 | TIME=641.68ms | IP=127.0.0.1
2025-06-08 01:13:40,382 - root - INFO - Request ebbee19b-aefe-46ed-b386-bcc436c2853e processed in 0.642s, is_safe: True
2025-06-08 01:13:40,383 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:13:40] "POST /check HTTP/1.1" 200 -
2025-06-08 01:13:40,389 - root - INFO - Request 49535f29-9a91-4b39-a5db-79b80eaf6116 received at /check
2025-06-08 01:13:40,587 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:13:40,781 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:13:40,782 - firewall_analysis - WARNING - FIREWALL_UNSAFE | STATUS=UNSAFE | HASH=e9329d3d5284be81 | TIME=392.9ms | TYPE=harmful_prompt | IP=127.0.0.1
2025-06-08 01:13:40,782 - root - INFO - Unsafe content detected: e9329d3d5284be81 (harmful_prompt)
2025-06-08 01:13:40,782 - root - INFO - Request 49535f29-9a91-4b39-a5db-79b80eaf6116 processed in 0.394s, is_safe: False
2025-06-08 01:13:40,783 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:13:40] "POST /check HTTP/1.1" 200 -
2025-06-08 01:13:40,788 - root - INFO - Request a87391a8-d305-4f53-a5c1-a3896051e61d received at /check
2025-06-08 01:13:40,788 - root - ERROR - Error in detailed logging: 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/Users/gelei/Research/LoAFirewall/src/core/firewall.py", line 364, in _log_detailed_analysis
    if match.get("type") == "keyword":
       ^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-08 01:13:40,789 - root - INFO - Request a87391a8-d305-4f53-a5c1-a3896051e61d processed in 0.001s, is_safe: False
2025-06-08 01:13:40,790 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:13:40] "POST /check HTTP/1.1" 200 -
2025-06-08 01:13:40,792 - root - INFO - Request 19e44d35-662b-48fc-b448-96fbdbc228ad received at /check
2025-06-08 01:13:40,988 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:13:41,226 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:13:41,227 - firewall_analysis - WARNING - FIREWALL_UNSAFE | STATUS=UNSAFE | HASH=77dfacf868c19c0c | TIME=435.14ms | TYPE=harmful_prompt | IP=127.0.0.1
2025-06-08 01:13:41,227 - root - INFO - Unsafe content detected: 77dfacf868c19c0c (harmful_prompt)
2025-06-08 01:13:41,228 - root - INFO - Request 19e44d35-662b-48fc-b448-96fbdbc228ad processed in 0.436s, is_safe: False
2025-06-08 01:13:41,228 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:13:41] "POST /check HTTP/1.1" 200 -
2025-06-08 01:13:41,232 - root - INFO - Request 059900e7-ccc1-4d05-9e80-0dcb3d05ca13 received at /check
2025-06-08 01:13:41,232 - root - ERROR - Error in detailed logging: 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/Users/gelei/Research/LoAFirewall/src/core/firewall.py", line 364, in _log_detailed_analysis
    if match.get("type") == "keyword":
       ^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-08 01:13:41,232 - root - INFO - Request 059900e7-ccc1-4d05-9e80-0dcb3d05ca13 processed in 0.001s, is_safe: False
2025-06-08 01:13:41,232 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:13:41] "POST /check HTTP/1.1" 200 -
2025-06-08 01:13:41,235 - root - INFO - Request 4c09e488-a5c6-44d1-b654-aa9db2654615 received at /check
2025-06-08 01:13:41,235 - root - ERROR - Error in detailed logging: 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/Users/gelei/Research/LoAFirewall/src/core/firewall.py", line 364, in _log_detailed_analysis
    if match.get("type") == "keyword":
       ^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-08 01:13:41,235 - root - INFO - Request 4c09e488-a5c6-44d1-b654-aa9db2654615 processed in 0.001s, is_safe: False
2025-06-08 01:13:41,236 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:13:41] "POST /check HTTP/1.1" 200 -
2025-06-08 01:13:41,238 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:13:41] "GET /keywords HTTP/1.1" 200 -
2025-06-08 01:13:41,240 - root - INFO - Keywords updated: 6 keywords, 4 patterns
2025-06-08 01:13:41,241 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:13:41] "PUT /keywords HTTP/1.1" 200 -
2025-06-08 01:13:41,242 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:13:41] "GET /keywords HTTP/1.1" 200 -
2025-06-08 01:13:41,244 - root - INFO - Request f60de461-b375-4943-ad4f-d537c1e44b31 received at /check
2025-06-08 01:13:41,244 - root - ERROR - Error in detailed logging: 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/Users/gelei/Research/LoAFirewall/src/core/firewall.py", line 364, in _log_detailed_analysis
    if match.get("type") == "keyword":
       ^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-08 01:13:41,245 - root - INFO - Request f60de461-b375-4943-ad4f-d537c1e44b31 processed in 0.000s, is_safe: False
2025-06-08 01:13:41,245 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:13:41] "POST /check HTTP/1.1" 200 -
2025-06-08 01:13:41,246 - root - INFO - Request 6d2248c6-b975-4558-b92c-8c5ba8482cc8 received at /check
2025-06-08 01:13:41,247 - root - ERROR - Error in detailed logging: 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/Users/gelei/Research/LoAFirewall/src/core/firewall.py", line 364, in _log_detailed_analysis
    if match.get("type") == "keyword":
       ^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-08 01:13:41,247 - root - INFO - Request 6d2248c6-b975-4558-b92c-8c5ba8482cc8 processed in 0.000s, is_safe: False
2025-06-08 01:13:41,247 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:13:41] "POST /check HTTP/1.1" 200 -
2025-06-08 01:13:41,249 - root - INFO - Request 8f0a3ede-dcd4-4611-be1b-3b0c452857ff received at /check
2025-06-08 01:13:41,376 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:13:41,569 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:13:41,570 - firewall_analysis - INFO - FIREWALL_SAFE | STATUS=SAFE | HASH=1f62f50e4a30f35f | TIME=320.85ms | IP=127.0.0.1
2025-06-08 01:13:41,570 - root - INFO - Request 8f0a3ede-dcd4-4611-be1b-3b0c452857ff processed in 0.321s, is_safe: True
2025-06-08 01:13:41,570 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:13:41] "POST /check HTTP/1.1" 200 -
2025-06-08 01:13:41,573 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:13:41] "[31m[1mPUT /keywords HTTP/1.1[0m" 400 -
2025-06-08 01:13:41,576 - root - INFO - Keywords updated: 3 keywords, 2 patterns
2025-06-08 01:13:41,577 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:13:41] "PUT /keywords HTTP/1.1" 200 -
2025-06-08 01:13:41,579 - root - INFO - Request 75bbbc73-6844-4801-8c5d-80ea82e753d1 received at /check
2025-06-08 01:13:41,705 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:13:41,898 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:13:41,899 - firewall_analysis - INFO - FIREWALL_SAFE | STATUS=SAFE | HASH=886d95dc824077a8 | TIME=320.48ms | IP=127.0.0.1
2025-06-08 01:13:41,900 - root - INFO - Request 75bbbc73-6844-4801-8c5d-80ea82e753d1 processed in 0.321s, is_safe: True
2025-06-08 01:13:41,900 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:13:41] "POST /check HTTP/1.1" 200 -
2025-06-08 01:13:41,904 - root - INFO - Request 76b7fa06-dbd4-4d56-ae00-44b400a4c432 received at /check
2025-06-08 01:13:41,943 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:13:41,982 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:13:41,983 - firewall_analysis - INFO - FIREWALL_SAFE | STATUS=SAFE | HASH=886d95dc824077a8 | TIME=78.84ms | IP=127.0.0.1
2025-06-08 01:13:41,983 - root - INFO - Request 76b7fa06-dbd4-4d56-ae00-44b400a4c432 processed in 0.079s, is_safe: True
2025-06-08 01:13:41,984 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:13:41] "POST /check HTTP/1.1" 200 -
2025-06-08 01:13:41,987 - root - INFO - Request 91ed2f9f-af33-4d57-ae6c-a396229bed98 received at /check
2025-06-08 01:13:42,026 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:13:42,065 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:13:42,066 - firewall_analysis - INFO - FIREWALL_SAFE | STATUS=SAFE | HASH=886d95dc824077a8 | TIME=78.36ms | IP=127.0.0.1
2025-06-08 01:13:42,066 - root - INFO - Request 91ed2f9f-af33-4d57-ae6c-a396229bed98 processed in 0.079s, is_safe: True
2025-06-08 01:13:42,066 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:13:42] "POST /check HTTP/1.1" 200 -
2025-06-08 01:13:42,070 - root - INFO - Request 92590922-f3d3-442e-a4bb-f119b8a12f58 received at /check
2025-06-08 01:13:42,415 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:13:42,891 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:13:42,892 - firewall_analysis - INFO - FIREWALL_SAFE | STATUS=SAFE | HASH=01c265ac59e32b74 | TIME=821.53ms | IP=127.0.0.1
2025-06-08 01:13:42,892 - root - INFO - Request 92590922-f3d3-442e-a4bb-f119b8a12f58 processed in 0.822s, is_safe: True
2025-06-08 01:13:42,893 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:13:42] "POST /check HTTP/1.1" 200 -
2025-06-08 01:13:42,896 - root - INFO - Request ba780721-98f3-40d2-9fa8-06ed6c797d1d received at /check
2025-06-08 01:13:42,936 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:13:42,977 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:13:42,978 - firewall_analysis - INFO - FIREWALL_SAFE | STATUS=SAFE | HASH=01c265ac59e32b74 | TIME=81.02ms | IP=127.0.0.1
2025-06-08 01:13:42,978 - root - INFO - Request ba780721-98f3-40d2-9fa8-06ed6c797d1d processed in 0.081s, is_safe: True
2025-06-08 01:13:42,978 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:13:42] "POST /check HTTP/1.1" 200 -
2025-06-08 01:13:42,980 - root - INFO - Request d36f6823-8c8f-4962-988c-a8226d18a8a4 received at /check
2025-06-08 01:13:43,021 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:13:43,061 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:13:43,061 - firewall_analysis - INFO - FIREWALL_SAFE | STATUS=SAFE | HASH=01c265ac59e32b74 | TIME=80.78ms | IP=127.0.0.1
2025-06-08 01:13:43,062 - root - INFO - Request d36f6823-8c8f-4962-988c-a8226d18a8a4 processed in 0.081s, is_safe: True
2025-06-08 01:13:43,062 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:13:43] "POST /check HTTP/1.1" 200 -
2025-06-08 01:13:43,065 - root - INFO - Request cefd29d1-876c-4aaf-b15c-35ce729ad0c4 received at /check
2025-06-08 01:13:43,066 - root - ERROR - Error in detailed logging: 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/Users/gelei/Research/LoAFirewall/src/core/firewall.py", line 364, in _log_detailed_analysis
    if match.get("type") == "keyword":
       ^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-08 01:13:43,066 - root - INFO - Request cefd29d1-876c-4aaf-b15c-35ce729ad0c4 processed in 0.001s, is_safe: False
2025-06-08 01:13:43,066 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:13:43] "POST /check HTTP/1.1" 200 -
2025-06-08 01:13:43,068 - root - INFO - Request c41a34a7-8d17-46a9-8b7b-c805996e48c4 received at /check
2025-06-08 01:13:43,069 - root - ERROR - Error in detailed logging: 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/Users/gelei/Research/LoAFirewall/src/core/firewall.py", line 364, in _log_detailed_analysis
    if match.get("type") == "keyword":
       ^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-08 01:13:43,069 - root - INFO - Request c41a34a7-8d17-46a9-8b7b-c805996e48c4 processed in 0.001s, is_safe: False
2025-06-08 01:13:43,069 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:13:43] "POST /check HTTP/1.1" 200 -
2025-06-08 01:13:43,071 - root - INFO - Request 28953969-77fb-48b8-8cde-23923b77a835 received at /check
2025-06-08 01:13:43,071 - root - ERROR - Error in detailed logging: 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/Users/gelei/Research/LoAFirewall/src/core/firewall.py", line 364, in _log_detailed_analysis
    if match.get("type") == "keyword":
       ^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-08 01:13:43,071 - root - INFO - Request 28953969-77fb-48b8-8cde-23923b77a835 processed in 0.000s, is_safe: False
2025-06-08 01:13:43,071 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:13:43] "POST /check HTTP/1.1" 200 -
2025-06-08 01:13:43,073 - root - INFO - Request 31f739fd-8cd1-4e4a-945c-f91e7401b027 received at /check
2025-06-08 01:13:43,227 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:13:43,463 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:13:43,463 - firewall_analysis - INFO - FIREWALL_SAFE | STATUS=SAFE | HASH=b7f9da7ee481a1d4 | TIME=390.19ms | IP=127.0.0.1
2025-06-08 01:13:43,463 - root - INFO - Request 31f739fd-8cd1-4e4a-945c-f91e7401b027 processed in 0.390s, is_safe: True
2025-06-08 01:13:43,464 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:13:43] "POST /check HTTP/1.1" 200 -
2025-06-08 01:13:43,467 - root - INFO - Request 65f0c38c-2a41-464c-bff7-9f8b0ecc3034 received at /check
2025-06-08 01:13:43,507 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:13:43,547 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:13:43,548 - firewall_analysis - INFO - FIREWALL_SAFE | STATUS=SAFE | HASH=b7f9da7ee481a1d4 | TIME=81.15ms | IP=127.0.0.1
2025-06-08 01:13:43,548 - root - INFO - Request 65f0c38c-2a41-464c-bff7-9f8b0ecc3034 processed in 0.082s, is_safe: True
2025-06-08 01:13:43,549 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:13:43] "POST /check HTTP/1.1" 200 -
2025-06-08 01:13:43,552 - root - INFO - Request ab7b3c5a-2c5f-4e21-9dfd-4d995f163811 received at /check
2025-06-08 01:13:43,591 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:13:43,632 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:13:43,632 - firewall_analysis - INFO - FIREWALL_SAFE | STATUS=SAFE | HASH=b7f9da7ee481a1d4 | TIME=80.38ms | IP=127.0.0.1
2025-06-08 01:13:43,632 - root - INFO - Request ab7b3c5a-2c5f-4e21-9dfd-4d995f163811 processed in 0.081s, is_safe: True
2025-06-08 01:13:43,633 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:13:43] "POST /check HTTP/1.1" 200 -
2025-06-08 01:13:43,635 - root - INFO - Request 623125d8-566f-4c94-89d5-8b35277bee7d received at /check
2025-06-08 01:13:43,635 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:13:43] "[31m[1mPOST /check HTTP/1.1[0m" 400 -
2025-06-08 01:13:43,637 - root - INFO - Request 7392ebeb-3fa5-4cc1-be2d-37c0e1ae3afa received at /check
2025-06-08 01:13:43,638 - root - WARNING - Request 7392ebeb-3fa5-4cc1-be2d-37c0e1ae3afa rejected: missing 'text' field
2025-06-08 01:13:43,638 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:13:43] "[31m[1mPOST /check HTTP/1.1[0m" 400 -
2025-06-08 01:13:43,640 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:13:43] "[33mGET /nonexistent HTTP/1.1[0m" 404 -
2025-06-08 01:17:57,465 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:17:57] "GET /health HTTP/1.1" 200 -
2025-06-08 01:17:57,466 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:17:57] "GET /health HTTP/1.1" 200 -
2025-06-08 01:17:57,468 - root - INFO - Request cb7c19b3-cca4-498c-be89-6d2b6fd75886 received at /check
2025-06-08 01:17:57,828 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:17:58,180 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:17:58,181 - firewall_analysis - INFO - FIREWALL_SAFE | STATUS=SAFE | HASH=9e46da316ef16f99 | TIME=712.83ms | IP=127.0.0.1
2025-06-08 01:17:58,181 - root - INFO - Request cb7c19b3-cca4-498c-be89-6d2b6fd75886 processed in 0.713s, is_safe: True
2025-06-08 01:17:58,181 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:17:58] "POST /check HTTP/1.1" 200 -
2025-06-08 01:17:58,185 - root - INFO - Request caa0b22d-b6a8-4360-a527-17f46fcd4a50 received at /check
2025-06-08 01:17:58,380 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:17:58,573 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:17:58,574 - firewall_analysis - WARNING - FIREWALL_UNSAFE | STATUS=UNSAFE | HASH=e9329d3d5284be81 | TIME=388.5ms | TYPE=harmful_prompt | IP=127.0.0.1
2025-06-08 01:17:58,574 - root - INFO - Unsafe content detected: e9329d3d5284be81 (harmful_prompt)
2025-06-08 01:17:58,574 - root - INFO - Request caa0b22d-b6a8-4360-a527-17f46fcd4a50 processed in 0.389s, is_safe: False
2025-06-08 01:17:58,575 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:17:58] "POST /check HTTP/1.1" 200 -
2025-06-08 01:17:58,579 - root - INFO - Request 668ae316-9187-4322-9cc2-df0d3187d7cd received at /check
2025-06-08 01:17:58,579 - root - ERROR - Error in detailed logging: 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/Users/gelei/Research/LoAFirewall/src/core/firewall.py", line 364, in _log_detailed_analysis
    if match.get("type") == "keyword":
       ^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-08 01:17:58,580 - root - INFO - Request 668ae316-9187-4322-9cc2-df0d3187d7cd processed in 0.001s, is_safe: False
2025-06-08 01:17:58,580 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:17:58] "POST /check HTTP/1.1" 200 -
2025-06-08 01:17:58,583 - root - INFO - Request 53dcbeb1-9f5c-4835-a827-8d94edbbf9ea received at /check
2025-06-08 01:17:58,779 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:17:59,016 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:17:59,017 - firewall_analysis - WARNING - FIREWALL_UNSAFE | STATUS=UNSAFE | HASH=77dfacf868c19c0c | TIME=434.1ms | TYPE=harmful_prompt | IP=127.0.0.1
2025-06-08 01:17:59,018 - root - INFO - Unsafe content detected: 77dfacf868c19c0c (harmful_prompt)
2025-06-08 01:17:59,018 - root - INFO - Request 53dcbeb1-9f5c-4835-a827-8d94edbbf9ea processed in 0.435s, is_safe: False
2025-06-08 01:17:59,018 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:17:59] "POST /check HTTP/1.1" 200 -
2025-06-08 01:17:59,022 - root - INFO - Request 5221d777-d6a4-4177-a004-c3a5a17e12ce received at /check
2025-06-08 01:17:59,022 - root - ERROR - Error in detailed logging: 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/Users/gelei/Research/LoAFirewall/src/core/firewall.py", line 364, in _log_detailed_analysis
    if match.get("type") == "keyword":
       ^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-08 01:17:59,023 - root - INFO - Request 5221d777-d6a4-4177-a004-c3a5a17e12ce processed in 0.001s, is_safe: False
2025-06-08 01:17:59,023 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:17:59] "POST /check HTTP/1.1" 200 -
2025-06-08 01:17:59,025 - root - INFO - Request 12044f4e-c736-48a2-9386-f5cf25acdc9f received at /check
2025-06-08 01:17:59,025 - root - ERROR - Error in detailed logging: 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/Users/gelei/Research/LoAFirewall/src/core/firewall.py", line 364, in _log_detailed_analysis
    if match.get("type") == "keyword":
       ^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-08 01:17:59,026 - root - INFO - Request 12044f4e-c736-48a2-9386-f5cf25acdc9f processed in 0.000s, is_safe: False
2025-06-08 01:17:59,026 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:17:59] "POST /check HTTP/1.1" 200 -
2025-06-08 01:17:59,028 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:17:59] "GET /keywords HTTP/1.1" 200 -
2025-06-08 01:17:59,029 - root - INFO - Keywords updated: 6 keywords, 4 patterns
2025-06-08 01:17:59,029 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:17:59] "PUT /keywords HTTP/1.1" 200 -
2025-06-08 01:17:59,030 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:17:59] "GET /keywords HTTP/1.1" 200 -
2025-06-08 01:17:59,032 - root - INFO - Request bed92d75-c6d8-4813-a0c1-b3a9d76cf132 received at /check
2025-06-08 01:17:59,032 - root - ERROR - Error in detailed logging: 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/Users/gelei/Research/LoAFirewall/src/core/firewall.py", line 364, in _log_detailed_analysis
    if match.get("type") == "keyword":
       ^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-08 01:17:59,032 - root - INFO - Request bed92d75-c6d8-4813-a0c1-b3a9d76cf132 processed in 0.000s, is_safe: False
2025-06-08 01:17:59,032 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:17:59] "POST /check HTTP/1.1" 200 -
2025-06-08 01:17:59,033 - root - INFO - Request 1cbecb02-c223-4c80-8fa2-24ba30b61c98 received at /check
2025-06-08 01:17:59,033 - root - ERROR - Error in detailed logging: 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/Users/gelei/Research/LoAFirewall/src/core/firewall.py", line 364, in _log_detailed_analysis
    if match.get("type") == "keyword":
       ^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-08 01:17:59,033 - root - INFO - Request 1cbecb02-c223-4c80-8fa2-24ba30b61c98 processed in 0.000s, is_safe: False
2025-06-08 01:17:59,033 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:17:59] "POST /check HTTP/1.1" 200 -
2025-06-08 01:17:59,034 - root - INFO - Request 71d557eb-1084-40ff-9e4f-747f610ef347 received at /check
2025-06-08 01:17:59,161 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:17:59,353 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:17:59,354 - firewall_analysis - INFO - FIREWALL_SAFE | STATUS=SAFE | HASH=1f62f50e4a30f35f | TIME=319.98ms | IP=127.0.0.1
2025-06-08 01:17:59,355 - root - INFO - Request 71d557eb-1084-40ff-9e4f-747f610ef347 processed in 0.320s, is_safe: True
2025-06-08 01:17:59,355 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:17:59] "POST /check HTTP/1.1" 200 -
2025-06-08 01:17:59,359 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:17:59] "[31m[1mPUT /keywords HTTP/1.1[0m" 400 -
2025-06-08 01:17:59,362 - root - INFO - Keywords updated: 3 keywords, 2 patterns
2025-06-08 01:17:59,362 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:17:59] "PUT /keywords HTTP/1.1" 200 -
2025-06-08 01:17:59,363 - root - INFO - Request f3b175d4-548c-4988-9311-a8565dfe7e09 received at /check
2025-06-08 01:17:59,489 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:17:59,682 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:17:59,683 - firewall_analysis - INFO - FIREWALL_SAFE | STATUS=SAFE | HASH=886d95dc824077a8 | TIME=319.27ms | IP=127.0.0.1
2025-06-08 01:17:59,683 - root - INFO - Request f3b175d4-548c-4988-9311-a8565dfe7e09 processed in 0.320s, is_safe: True
2025-06-08 01:17:59,683 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:17:59] "POST /check HTTP/1.1" 200 -
2025-06-08 01:17:59,687 - root - INFO - Request 2f149915-db91-4c16-8eca-c77835850b90 received at /check
2025-06-08 01:17:59,727 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:17:59,767 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:17:59,768 - firewall_analysis - INFO - FIREWALL_SAFE | STATUS=SAFE | HASH=886d95dc824077a8 | TIME=80.85ms | IP=127.0.0.1
2025-06-08 01:17:59,768 - root - INFO - Request 2f149915-db91-4c16-8eca-c77835850b90 processed in 0.081s, is_safe: True
2025-06-08 01:17:59,769 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:17:59] "POST /check HTTP/1.1" 200 -
2025-06-08 01:17:59,772 - root - INFO - Request b5a8282d-4d4d-4b08-9ff7-768b9e52f5a8 received at /check
2025-06-08 01:17:59,811 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:17:59,850 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:17:59,851 - firewall_analysis - INFO - FIREWALL_SAFE | STATUS=SAFE | HASH=886d95dc824077a8 | TIME=78.76ms | IP=127.0.0.1
2025-06-08 01:17:59,851 - root - INFO - Request b5a8282d-4d4d-4b08-9ff7-768b9e52f5a8 processed in 0.079s, is_safe: True
2025-06-08 01:17:59,851 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:17:59] "POST /check HTTP/1.1" 200 -
2025-06-08 01:17:59,855 - root - INFO - Request c79dcf6e-85a6-4389-8d3d-ca480da9a4de received at /check
2025-06-08 01:18:00,199 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:18:00,676 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:18:00,677 - firewall_analysis - INFO - FIREWALL_SAFE | STATUS=SAFE | HASH=01c265ac59e32b74 | TIME=821.73ms | IP=127.0.0.1
2025-06-08 01:18:00,677 - root - INFO - Request c79dcf6e-85a6-4389-8d3d-ca480da9a4de processed in 0.822s, is_safe: True
2025-06-08 01:18:00,677 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:18:00] "POST /check HTTP/1.1" 200 -
2025-06-08 01:18:00,681 - root - INFO - Request ae14fddf-f7d2-4bad-8d6e-853628b2134a received at /check
2025-06-08 01:18:00,721 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:18:00,762 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:18:00,763 - firewall_analysis - INFO - FIREWALL_SAFE | STATUS=SAFE | HASH=01c265ac59e32b74 | TIME=82.09ms | IP=127.0.0.1
2025-06-08 01:18:00,763 - root - INFO - Request ae14fddf-f7d2-4bad-8d6e-853628b2134a processed in 0.083s, is_safe: True
2025-06-08 01:18:00,764 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:18:00] "POST /check HTTP/1.1" 200 -
2025-06-08 01:18:00,768 - root - INFO - Request bf96cdb5-fcc4-4320-88a7-2f4196f49d66 received at /check
2025-06-08 01:18:00,809 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:18:00,849 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:18:00,850 - firewall_analysis - INFO - FIREWALL_SAFE | STATUS=SAFE | HASH=01c265ac59e32b74 | TIME=82.0ms | IP=127.0.0.1
2025-06-08 01:18:00,850 - root - INFO - Request bf96cdb5-fcc4-4320-88a7-2f4196f49d66 processed in 0.082s, is_safe: True
2025-06-08 01:18:00,850 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:18:00] "POST /check HTTP/1.1" 200 -
2025-06-08 01:18:00,854 - root - INFO - Request 5bf30dee-1212-4bd8-a12a-e89eb46bdb49 received at /check
2025-06-08 01:18:00,854 - root - ERROR - Error in detailed logging: 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/Users/gelei/Research/LoAFirewall/src/core/firewall.py", line 364, in _log_detailed_analysis
    if match.get("type") == "keyword":
       ^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-08 01:18:00,854 - root - INFO - Request 5bf30dee-1212-4bd8-a12a-e89eb46bdb49 processed in 0.001s, is_safe: False
2025-06-08 01:18:00,854 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:18:00] "POST /check HTTP/1.1" 200 -
2025-06-08 01:18:00,857 - root - INFO - Request bb339cd8-1cd6-416d-a4aa-aa78b38e04ae received at /check
2025-06-08 01:18:00,857 - root - ERROR - Error in detailed logging: 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/Users/gelei/Research/LoAFirewall/src/core/firewall.py", line 364, in _log_detailed_analysis
    if match.get("type") == "keyword":
       ^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-08 01:18:00,857 - root - INFO - Request bb339cd8-1cd6-416d-a4aa-aa78b38e04ae processed in 0.001s, is_safe: False
2025-06-08 01:18:00,858 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:18:00] "POST /check HTTP/1.1" 200 -
2025-06-08 01:18:00,859 - root - INFO - Request 0839aae3-0a52-47ea-83e2-cb80ad636bb6 received at /check
2025-06-08 01:18:00,859 - root - ERROR - Error in detailed logging: 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/Users/gelei/Research/LoAFirewall/src/core/firewall.py", line 364, in _log_detailed_analysis
    if match.get("type") == "keyword":
       ^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-08 01:18:00,859 - root - INFO - Request 0839aae3-0a52-47ea-83e2-cb80ad636bb6 processed in 0.000s, is_safe: False
2025-06-08 01:18:00,860 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:18:00] "POST /check HTTP/1.1" 200 -
2025-06-08 01:18:00,861 - root - INFO - Request 0f50ebb7-c996-4e45-ae17-019e8382e523 received at /check
2025-06-08 01:18:01,015 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:18:01,251 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:18:01,252 - firewall_analysis - INFO - FIREWALL_SAFE | STATUS=SAFE | HASH=b7f9da7ee481a1d4 | TIME=390.66ms | IP=127.0.0.1
2025-06-08 01:18:01,252 - root - INFO - Request 0f50ebb7-c996-4e45-ae17-019e8382e523 processed in 0.391s, is_safe: True
2025-06-08 01:18:01,252 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:18:01] "POST /check HTTP/1.1" 200 -
2025-06-08 01:18:01,255 - root - INFO - Request 39140e36-4278-4cb5-85cf-bc8b7a022768 received at /check
2025-06-08 01:18:01,294 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:18:01,333 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:18:01,334 - firewall_analysis - INFO - FIREWALL_SAFE | STATUS=SAFE | HASH=b7f9da7ee481a1d4 | TIME=78.84ms | IP=127.0.0.1
2025-06-08 01:18:01,334 - root - INFO - Request 39140e36-4278-4cb5-85cf-bc8b7a022768 processed in 0.079s, is_safe: True
2025-06-08 01:18:01,334 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:18:01] "POST /check HTTP/1.1" 200 -
2025-06-08 01:18:01,336 - root - INFO - Request 49630ca5-4d34-4ca1-a544-ed88ffe06058 received at /check
2025-06-08 01:18:01,375 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:18:01,416 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/chat "HTTP/1.1 200 OK"
2025-06-08 01:18:01,416 - firewall_analysis - INFO - FIREWALL_SAFE | STATUS=SAFE | HASH=b7f9da7ee481a1d4 | TIME=80.04ms | IP=127.0.0.1
2025-06-08 01:18:01,416 - root - INFO - Request 49630ca5-4d34-4ca1-a544-ed88ffe06058 processed in 0.080s, is_safe: True
2025-06-08 01:18:01,416 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:18:01] "POST /check HTTP/1.1" 200 -
2025-06-08 01:18:01,418 - root - INFO - Request 9e0be094-f4ba-4216-b054-cc0bda5a487f received at /check
2025-06-08 01:18:01,418 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:18:01] "[31m[1mPOST /check HTTP/1.1[0m" 400 -
2025-06-08 01:18:01,420 - root - INFO - Request eea44cdb-ca31-4f4d-9b4f-48ebfde9174b received at /check
2025-06-08 01:18:01,420 - root - WARNING - Request eea44cdb-ca31-4f4d-9b4f-48ebfde9174b rejected: missing 'text' field
2025-06-08 01:18:01,420 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:18:01] "[31m[1mPOST /check HTTP/1.1[0m" 400 -
2025-06-08 01:18:01,421 - werkzeug - INFO - 127.0.0.1 - - [08/Jun/2025 01:18:01] "[33mGET /nonexistent HTTP/1.1[0m" 404 -
